!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,t,i){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=3)}([function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.$=OpenSeadragon,t.DIRECTION_HORIZONTAL=Symbol("horizontal"),t.DIRECTION_VERTICAL=Symbol("vertical")},function(e,t,i){"use strict";function n(e,t,i,n){var r=n===a.DIRECTION_HORIZONTAL?"horizontal":"vertical",d=s(),u=d.find(function(t){return t.id===e});u?(u.x=t,u.y=i):d.push({id:e,x:t,y:i,direction:r}),o(d)}function r(e){var t=s();o(t.filter(function(t){return t.id!==e}))}function s(){var e=window.sessionStorage.getItem(u);return e?JSON.parse(e):[]}function o(e){window.sessionStorage.setItem(u,JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),d=!1,u="openseadragon-guides";t.default={addGuide:n,deleteGuide:r,getGuides:s,useStorage:d}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){var i=document.createElement("div");switch(i.id="osd-guide-"+t,i.classList.add("osd-guide"),e){case a.DIRECTION_HORIZONTAL:i.classList.add("osd-guide-horizontal");break;case a.DIRECTION_VERTICAL:i.classList.add("osd-guide-vertical");break;default:throw new Error("Invalid guide direction")}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.Guide=void 0;var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(0),d=i(1),u=n(d);t.Guide=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.DIRECTION_HORIZONTAL,n=arguments[2],o=arguments[3],d=arguments[4];r(this,e),this.viewer=t,this.direction=i,this.id=n?n:Date.now(),this.point=this.viewer.viewport.getCenter(),this.point.x=o?o:this.point.x,this.point.y=d?d:this.point.y,this.elem=s(this.direction,this.id),this.overlay=new a.$.Overlay(this.elem,this.point),this.draw(),this.saveInStorage(),this.addHandlers()}return o(e,[{key:"addHandlers",value:function(){this.tracker=new a.$.MouseTracker({element:this.elem,clickTimeThreshold:this.viewer.clickTimeThreshold,clickDistThreshold:this.viewer.clickDistThreshold,dragHandler:this.dragHandler.bind(this),dragEndHandler:this.dragEndHandler.bind(this),dblClickHandler:this.remove.bind(this)}),this.viewer.addHandler("open",this.draw.bind(this)),this.viewer.addHandler("animation",this.draw.bind(this)),this.viewer.addHandler("resize",this.draw.bind(this)),this.viewer.addHandler("rotate",this.draw.bind(this))}},{key:"dragHandler",value:function(e){var t=this.viewer.viewport.deltaPointsFromPixels(e.delta,!0);switch(this.direction){case a.DIRECTION_HORIZONTAL:this.point.y+=t.y;break;case a.DIRECTION_VERTICAL:this.point.x+=t.x}this.elem.classList.add("osd-guide-drag"),this.draw()}},{key:"dragEndHandler",value:function(){this.elem.classList.remove("osd-guide-drag"),this.saveInStorage()}},{key:"draw",value:function(){return this.point&&(this.overlay.update(this.point),this.overlay.drawHTML(this.viewer.drawer.container,this.viewer.viewport)),this}},{key:"remove",value:function(){return this.viewer.removeHandler("open",this.draw.bind(this)),this.viewer.removeHandler("animation",this.draw.bind(this)),this.viewer.removeHandler("resize",this.draw.bind(this)),this.viewer.removeHandler("rotate",this.draw.bind(this)),this.overlay.destroy(),this.point=null,u.default.deleteGuide(this.id),this}},{key:"saveInStorage",value:function(){u.default.useStorage&&u.default.addGuide(this.id,this.point.x,this.point.y,this.direction)}}]),e}()},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=i(2),s=i(0),o=i(1),a=n(o);if(!s.$.version||s.$.version.major<2)throw new Error("This version of OpenSeadragon Guides requires OpenSeadragon version 2.0.0+");s.$.Viewer.prototype.guides=function(e){return this.guidesInstance&&!e||(e=e||{},e.viewer=this,this.guidesInstance=new s.$.Guides(e)),this.guidesInstance},s.$.Guides=function(e){var t=this;s.$.extend(!0,this,{viewer:null,guides:[],horizontalGuideButton:null,verticalGuideButton:null,prefixUrl:null,removeOnClose:!1,useSessionStorage:!1,navImages:{guideHorizontal:{REST:"button_rest.png",GROUP:"button_grouphover.png",HOVER:"button_hover.png",DOWN:"button_pressed.png"},guideVertical:{REST:"button_rest.png",GROUP:"button_grouphover.png",HOVER:"button_hover.png",DOWN:"button_pressed.png"}}},e),s.$.extend(!0,this.navImages,this.viewer.navImages);var i=this.prefixUrl||this.viewer.prefixUrl||"",n=this.viewer.buttons&&this.viewer.buttons.buttons,o=n?this.viewer.buttons.buttons[0]:null,d=o?o.onFocus:null,u=o?o.onBlur:null;if(this.horizontalGuideButton=new s.$.Button({element:this.horizontalGuideButton?s.$.getElement(this.horizontalGuideButton):null,clickTimeThreshold:this.viewer.clickTimeThreshold,clickDistThreshold:this.viewer.clickDistThreshold,tooltip:s.$.getString("Tooltips.HorizontalGuide")||"Horizontal guide",srcRest:i+this.navImages.guideHorizontal.REST,srcGroup:i+this.navImages.guideHorizontal.GROUP,srcHover:i+this.navImages.guideHorizontal.HOVER,srcDown:i+this.navImages.guideHorizontal.DOWN,onRelease:this.createHorizontalGuide.bind(this),onFocus:d,onBlur:u}),this.verticalGuideButton=new s.$.Button({element:this.verticalGuideButton?s.$.getElement(this.verticalGuideButton):null,clickTimeThreshold:this.viewer.clickTimeThreshold,clickDistThreshold:this.viewer.clickDistThreshold,tooltip:s.$.getString("Tooltips.VerticalGuide")||"vertical guide",srcRest:i+this.navImages.guideVertical.REST,srcGroup:i+this.navImages.guideVertical.GROUP,srcHover:i+this.navImages.guideVertical.HOVER,srcDown:i+this.navImages.guideVertical.DOWN,onRelease:this.createVerticalGuide.bind(this),onFocus:d,onBlur:u}),n&&(this.viewer.buttons.buttons.push(this.horizontalGuideButton),this.viewer.buttons.element.appendChild(this.horizontalGuideButton.element),this.viewer.buttons.buttons.push(this.verticalGuideButton),this.viewer.buttons.element.appendChild(this.verticalGuideButton.element)),a.default.useStorage=this.useSessionStorage,a.default.useStorage){var l=a.default.getGuides();l.forEach(function(e){t.guides.push(new r.Guide(t.viewer,"horizontal"===e.direction?s.DIRECTION_HORIZONTAL:s.DIRECTION_VERTICAL,e.id,e.x,e.y))})}this.removeOnClose&&this.viewer.addHandler("close",function(){t.guides.forEach(function(e){return e.remove()}),t.guides=[]})},s.$.extend(s.$.Guides.prototype,{createHorizontalGuide:function(){this.guides.push(new r.Guide(this.viewer,s.DIRECTION_HORIZONTAL))},createVerticalGuide:function(){this.guides.push(new r.Guide(this.viewer,s.DIRECTION_VERTICAL))}})}]);
//# sourceMappingURL=openseadragon-guides.js.map